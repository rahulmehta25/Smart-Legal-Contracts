<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Monitoring Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .status-bar {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-dot.healthy { background: #10b981; }
        .status-dot.warning { background: #f59e0b; }
        .status-dot.critical { background: #ef4444; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .metric-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .metric-title {
            font-size: 14px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .metric-change {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .metric-change.positive {
            background: #d1fae5;
            color: #065f46;
        }
        
        .metric-change.negative {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .chart-controls {
            display: flex;
            gap: 10px;
        }
        
        .chart-button {
            padding: 6px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background: white;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .chart-button:hover {
            background: #f3f4f6;
        }
        
        .chart-button.active {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }
        
        .chart {
            height: 300px;
            position: relative;
        }
        
        .performance-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .performance-table th {
            background: #f9fafb;
            padding: 12px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .performance-table td {
            padding: 12px;
            border-top: 1px solid #e5e7eb;
            font-size: 14px;
            color: #1f2937;
        }
        
        .performance-table tr:hover {
            background: #f9fafb;
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .badge.success { background: #d1fae5; color: #065f46; }
        .badge.warning { background: #fed7aa; color: #92400e; }
        .badge.error { background: #fee2e2; color: #991b1b; }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            transition: width 0.3s ease;
        }
        
        .alert-box {
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .alert-title {
            color: #991b1b;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .alert-message {
            color: #dc2626;
            font-size: 14px;
        }
        
        .realtime-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            margin-left: 8px;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <div class="header">
            <h1>Performance Monitoring Dashboard <span class="realtime-indicator"></span></h1>
            <div class="status-bar">
                <div class="status-indicator">
                    <div class="status-dot healthy"></div>
                    <span>System Health: Optimal</span>
                </div>
                <div class="status-indicator">
                    <span>Last Updated: <span id="lastUpdate">--:--:--</span></span>
                </div>
                <div class="status-indicator">
                    <span>Active Users: <strong id="activeUsers">0</strong></span>
                </div>
                <div class="status-indicator">
                    <span>Uptime: <strong>99.99%</strong></span>
                </div>
            </div>
        </div>

        <!-- Alerts -->
        <div id="alertsContainer"></div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Response Time (P50)</span>
                    <span class="metric-change positive">-12%</span>
                </div>
                <div class="metric-value" id="responseTimeP50">--ms</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 30%"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Response Time (P95)</span>
                    <span class="metric-change positive">-8%</span>
                </div>
                <div class="metric-value" id="responseTimeP95">--ms</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 45%"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Response Time (P99)</span>
                    <span class="metric-change negative">+3%</span>
                </div>
                <div class="metric-value" id="responseTimeP99">--ms</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 65%"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Requests/Second</span>
                    <span class="metric-change positive">+25%</span>
                </div>
                <div class="metric-value" id="requestsPerSecond">--</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 80%"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Error Rate</span>
                    <span class="metric-change positive">-50%</span>
                </div>
                <div class="metric-value" id="errorRate">--%</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 5%"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Cache Hit Rate</span>
                    <span class="metric-change positive">+5%</span>
                </div>
                <div class="metric-value" id="cacheHitRate">--%</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 85%"></div>
                </div>
            </div>
        </div>

        <!-- Response Time Chart -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Response Time Trends</h2>
                <div class="chart-controls">
                    <button class="chart-button active" onclick="updateTimeRange('1h')">1H</button>
                    <button class="chart-button" onclick="updateTimeRange('6h')">6H</button>
                    <button class="chart-button" onclick="updateTimeRange('24h')">24H</button>
                    <button class="chart-button" onclick="updateTimeRange('7d')">7D</button>
                </div>
            </div>
            <div class="chart" id="responseTimeChart">
                <canvas id="rtChart"></canvas>
            </div>
        </div>

        <!-- Throughput Chart -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Throughput & Error Rate</h2>
                <div class="chart-controls">
                    <button class="chart-button active">Real-time</button>
                </div>
            </div>
            <div class="chart" id="throughputChart">
                <canvas id="tpChart"></canvas>
            </div>
        </div>

        <!-- Performance Budget Status -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Performance Budget Status</h2>
            </div>
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Current</th>
                        <th>Budget</th>
                        <th>Status</th>
                        <th>Utilization</th>
                    </tr>
                </thead>
                <tbody id="budgetTableBody">
                    <!-- Dynamically populated -->
                </tbody>
            </table>
        </div>

        <!-- Slow Queries -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Slow Queries</h2>
            </div>
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>Query</th>
                        <th>Execution Time</th>
                        <th>Count</th>
                        <th>Impact</th>
                    </tr>
                </thead>
                <tbody id="slowQueriesTableBody">
                    <!-- Dynamically populated -->
                </tbody>
            </table>
        </div>

        <!-- System Resources -->
        <div class="metrics-grid">
            <div class="chart-container">
                <h3 class="chart-title">CPU Usage</h3>
                <div class="chart" style="height: 200px;">
                    <canvas id="cpuChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">Memory Usage</h3>
                <div class="chart" style="height: 200px;">
                    <canvas id="memoryChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">Network I/O</h3>
                <div class="chart" style="height: 200px;">
                    <canvas id="networkChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Mock data generator
        function generateMockData() {
            return {
                responseTimeP50: Math.floor(Math.random() * 50 + 30),
                responseTimeP95: Math.floor(Math.random() * 200 + 100),
                responseTimeP99: Math.floor(Math.random() * 500 + 300),
                requestsPerSecond: Math.floor(Math.random() * 2000 + 1000),
                errorRate: (Math.random() * 2).toFixed(2),
                cacheHitRate: (Math.random() * 20 + 75).toFixed(1),
                activeUsers: Math.floor(Math.random() * 5000 + 5000),
                cpuUsage: Math.random() * 30 + 40,
                memoryUsage: Math.random() * 20 + 60,
                networkIn: Math.random() * 100 + 50,
                networkOut: Math.random() * 150 + 100
            };
        }

        // Update metrics
        function updateMetrics() {
            const data = generateMockData();
            
            document.getElementById('responseTimeP50').textContent = data.responseTimeP50 + 'ms';
            document.getElementById('responseTimeP95').textContent = data.responseTimeP95 + 'ms';
            document.getElementById('responseTimeP99').textContent = data.responseTimeP99 + 'ms';
            document.getElementById('requestsPerSecond').textContent = data.requestsPerSecond.toLocaleString();
            document.getElementById('errorRate').textContent = data.errorRate + '%';
            document.getElementById('cacheHitRate').textContent = data.cacheHitRate + '%';
            document.getElementById('activeUsers').textContent = data.activeUsers.toLocaleString();
            
            // Update timestamp
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
            
            // Check for alerts
            checkAlerts(data);
            
            // Update charts
            updateCharts(data);
        }

        // Check for performance alerts
        function checkAlerts(data) {
            const alertsContainer = document.getElementById('alertsContainer');
            alertsContainer.innerHTML = '';
            
            if (data.responseTimeP99 > 800) {
                const alert = createAlert('High Response Time', `P99 latency is ${data.responseTimeP99}ms (threshold: 800ms)`);
                alertsContainer.appendChild(alert);
            }
            
            if (data.errorRate > 1) {
                const alert = createAlert('High Error Rate', `Error rate is ${data.errorRate}% (threshold: 1%)`);
                alertsContainer.appendChild(alert);
            }
        }

        // Create alert element
        function createAlert(title, message) {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert-box';
            alertDiv.innerHTML = `
                <div class="alert-title">${title}</div>
                <div class="alert-message">${message}</div>
            `;
            return alertDiv;
        }

        // Update budget table
        function updateBudgetTable() {
            const budgets = [
                { metric: 'API Response P50', current: '45ms', budget: '100ms', status: 'success', utilization: 45 },
                { metric: 'API Response P95', current: '180ms', budget: '500ms', status: 'success', utilization: 36 },
                { metric: 'API Response P99', current: '750ms', budget: '2000ms', status: 'warning', utilization: 75 },
                { metric: 'Error Rate', current: '0.5%', budget: '1%', status: 'success', utilization: 50 },
                { metric: 'Cache Hit Rate', current: '85%', budget: '80%', status: 'success', utilization: 106 },
                { metric: 'Memory Usage', current: '3.2GB', budget: '4GB', status: 'warning', utilization: 80 }
            ];
            
            const tbody = document.getElementById('budgetTableBody');
            tbody.innerHTML = budgets.map(budget => `
                <tr>
                    <td>${budget.metric}</td>
                    <td>${budget.current}</td>
                    <td>${budget.budget}</td>
                    <td><span class="badge ${budget.status}">${budget.status.toUpperCase()}</span></td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(budget.utilization, 100)}%"></div>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // Update slow queries table
        function updateSlowQueriesTable() {
            const queries = [
                { query: 'SELECT * FROM orders WHERE...', time: '1.2s', count: 45, impact: 'HIGH' },
                { query: 'UPDATE users SET last_login...', time: '0.8s', count: 120, impact: 'MEDIUM' },
                { query: 'SELECT COUNT(*) FROM transactions...', time: '0.6s', count: 200, impact: 'LOW' }
            ];
            
            const tbody = document.getElementById('slowQueriesTableBody');
            tbody.innerHTML = queries.map(query => `
                <tr>
                    <td><code>${query.query}</code></td>
                    <td>${query.time}</td>
                    <td>${query.count}</td>
                    <td><span class="badge ${query.impact === 'HIGH' ? 'error' : query.impact === 'MEDIUM' ? 'warning' : 'success'}">${query.impact}</span></td>
                </tr>
            `).join('');
        }

        // Initialize charts
        let responseTimeChart, throughputChart, cpuChart, memoryChart, networkChart;

        function initCharts() {
            // Response Time Chart
            const rtCtx = document.getElementById('rtChart').getContext('2d');
            responseTimeChart = new Chart(rtCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 20}, (_, i) => `${i}m`),
                    datasets: [{
                        label: 'P50',
                        data: Array.from({length: 20}, () => Math.random() * 50 + 30),
                        borderColor: '#10b981',
                        tension: 0.4
                    }, {
                        label: 'P95',
                        data: Array.from({length: 20}, () => Math.random() * 200 + 100),
                        borderColor: '#f59e0b',
                        tension: 0.4
                    }, {
                        label: 'P99',
                        data: Array.from({length: 20}, () => Math.random() * 500 + 300),
                        borderColor: '#ef4444',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Response Time (ms)'
                            }
                        }
                    }
                }
            });

            // Throughput Chart
            const tpCtx = document.getElementById('tpChart').getContext('2d');
            throughputChart = new Chart(tpCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 20}, (_, i) => `${i}m`),
                    datasets: [{
                        label: 'Requests/sec',
                        data: Array.from({length: 20}, () => Math.random() * 1000 + 1000),
                        borderColor: '#6366f1',
                        yAxisID: 'y',
                        tension: 0.4
                    }, {
                        label: 'Error Rate %',
                        data: Array.from({length: 20}, () => Math.random() * 2),
                        borderColor: '#ef4444',
                        yAxisID: 'y1',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Requests/sec'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Error Rate %'
                            },
                            grid: {
                                drawOnChartArea: false,
                            }
                        }
                    }
                }
            });

            // CPU Chart
            const cpuCtx = document.getElementById('cpuChart').getContext('2d');
            cpuChart = new Chart(cpuCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 10}, (_, i) => `${i}m`),
                    datasets: [{
                        label: 'CPU %',
                        data: Array.from({length: 10}, () => Math.random() * 30 + 40),
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            // Memory Chart
            const memCtx = document.getElementById('memoryChart').getContext('2d');
            memoryChart = new Chart(memCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 10}, (_, i) => `${i}m`),
                    datasets: [{
                        label: 'Memory %',
                        data: Array.from({length: 10}, () => Math.random() * 20 + 60),
                        borderColor: '#ec4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            // Network Chart
            const netCtx = document.getElementById('networkChart').getContext('2d');
            networkChart = new Chart(netCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 10}, (_, i) => `${i}m`),
                    datasets: [{
                        label: 'In (MB/s)',
                        data: Array.from({length: 10}, () => Math.random() * 100 + 50),
                        borderColor: '#14b8a6',
                        tension: 0.4
                    }, {
                        label: 'Out (MB/s)',
                        data: Array.from({length: 10}, () => Math.random() * 150 + 100),
                        borderColor: '#f97316',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Update charts with new data
        function updateCharts(data) {
            // Add new data points and remove old ones
            if (responseTimeChart) {
                responseTimeChart.data.datasets[0].data.push(data.responseTimeP50);
                responseTimeChart.data.datasets[0].data.shift();
                responseTimeChart.data.datasets[1].data.push(data.responseTimeP95);
                responseTimeChart.data.datasets[1].data.shift();
                responseTimeChart.data.datasets[2].data.push(data.responseTimeP99);
                responseTimeChart.data.datasets[2].data.shift();
                responseTimeChart.update('none');
            }

            if (throughputChart) {
                throughputChart.data.datasets[0].data.push(data.requestsPerSecond);
                throughputChart.data.datasets[0].data.shift();
                throughputChart.data.datasets[1].data.push(parseFloat(data.errorRate));
                throughputChart.data.datasets[1].data.shift();
                throughputChart.update('none');
            }

            if (cpuChart) {
                cpuChart.data.datasets[0].data.push(data.cpuUsage);
                cpuChart.data.datasets[0].data.shift();
                cpuChart.update('none');
            }

            if (memoryChart) {
                memoryChart.data.datasets[0].data.push(data.memoryUsage);
                memoryChart.data.datasets[0].data.shift();
                memoryChart.update('none');
            }

            if (networkChart) {
                networkChart.data.datasets[0].data.push(data.networkIn);
                networkChart.data.datasets[0].data.shift();
                networkChart.data.datasets[1].data.push(data.networkOut);
                networkChart.data.datasets[1].data.shift();
                networkChart.update('none');
            }
        }

        // Update time range
        function updateTimeRange(range) {
            // Update button states
            document.querySelectorAll('.chart-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Would fetch new data based on time range
            console.log('Updating time range to:', range);
        }

        // Initialize dashboard
        window.addEventListener('DOMContentLoaded', () => {
            initCharts();
            updateMetrics();
            updateBudgetTable();
            updateSlowQueriesTable();
            
            // Auto-refresh every 5 seconds
            setInterval(() => {
                updateMetrics();
            }, 5000);
        });
    </script>
</body>
</html>